<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>AR Box</title>
  <script src="https://cdn.jsdelivr.net/npm/aframe@1.5.0/dist/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ar.js@3.4.4/aframe/build/aframe-ar.min.js"></script>
  <style>
    html,body { margin:0; height:100%; background:#000; }
    .btn { position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); z-index:9999;
           padding:12px 18px; border-radius:10px; background:#111; color:#fff; border:1px solid #555; }
  </style>
</head>
<body>
  <button id="start" class="btn">Запустить AR</button>
  <div id="app"></div>

  <script>
    const btn = document.getElementById('start');
    const app = document.getElementById('app');

    btn.addEventListener('click', () => {
      btn.style.display = 'none';
      app.innerHTML = `
        <a-scene embedded vr-mode-ui="enabled:false"
                 renderer="colorManagement:true; physicallyCorrectLights:true;"
                 arjs="trackingMethod: best; sourceType: webcam; facingMode: environment; debugUIEnabled:false;">
          <a-marker preset="hiro">
            <a-entity id="swarm"></a-entity>
          </a-marker>
          <a-entity camera></a-entity>
        </a-scene>`;

      const scene = app.querySelector('a-scene');
      scene.addEventListener('loaded', () => {
        const swarm = scene.querySelector('#swarm');
        const COUNT = 20;
        for(let i=0;i<COUNT;i++){
          const box=document.createElement('a-box');
          box.setAttribute('depth',0.05);
          box.setAttribute('height',0.2);
          box.setAttribute('width',0.2);
          const x=(i-COUNT/2)*0.08, y=Math.sin(i*0.5)*0.2+0.25, z=(Math.random()-0.5)*0.5;
          box.setAttribute('position',`${x.toFixed(2)} ${y.toFixed(2)} ${z.toFixed(2)}`);
          box.setAttribute('material','color: hsl('+(200+i*10)+',70%,70%); opacity:0.8; transparent:true');
          swarm.appendChild(box);
        }
      });
    });
  </script>
</body>
</html>
